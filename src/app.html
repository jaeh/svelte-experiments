<div class='app'>
  <Header menu='{{ menu }}' on:navigate='navigate(event)' />

  <article class='page'>
    <div>Route: {{ route }}</div>

    {{#if route === '/'}}
      <IndexPage />
    {{/if}}

    {{#if route === '/timer'}}
      <TimerPage />
    {{/if}}

    {{#if route === '/categories'}}
      <CategoriesPage />
    {{/if}}
  </article>
</div>

<style>
  .app {
    display: flex;
    flex-direction: column;
    max-width: 1500px;
    margin: 0 auto;
    min-height: 100vh;
    width: 90vw;
  }
  .page {
    margin: 5rem 0 0 0;
  }
</style>

<script>
  import Header from './components/header'
  import IndexPage from './pages/home'
  import TimerPage from './pages/timer'
  import CategoriesPage from './pages/categories'

  export default {
    data:
      () => ({
        count: 0,
        route: window.location.pathname || '/',
        menu: [
          { href: '/', text: 'home' },
          { href: '/timer', text: 'timer' },
          { href: '/categories', text: 'categories' },
        ],
      }),

    methods: {
      navigate({ href }) {
        const { host, protocol } = window.location
        const route = href.replace(`${ protocol }//${ host }`, '')

        history.pushState(null, null, href )
        this.set({ route })
      },
    },

    onrender() {
      window.addEventListener('popstate', () => {
        // this.set({ time: new Date() });
        console.log('popstate')
      })
    },

    onteardown() {
      window.removeEventListener('popstate')
    },

    components: {
      Header,
      IndexPage,
      TimerPage,
      CategoriesPage,
    },
  }
</script>
