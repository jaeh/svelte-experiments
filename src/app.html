<div class='app'>
  <Header menu='{{ menu }}' on:navigate='navigate(event)' />

  <div>Route: {{ route }}</div>

  {{#if route === '/'}}
    <IndexPage />
  {{/if}}

  {{#if route === '/timer'}}
    <TimerPage />
  {{/if}}

  {{#if route === '/categories'}}
    <CategoriesPage />
  {{/if}}
</div>

<style>
  .app {
    height: 100vh;
    width: 100vw;
    display: flex;
    flex-direction: column;
  }
</style>

<script>
  import Header from './components/header'
  import IndexPage from './pages/home'
  import TimerPage from './pages/timer'
  import CategoriesPage from './pages/categories'

  export default {
    data:
      () => ({
        count: 0,
        route: window.location.pathname || '/',
        menu: [
          { href: '/', text: 'home' },
          { href: '/timer', text: 'timer' },
          { href: '/categories', text: 'categories' },
        ],
      }),

    methods: {
      navigate({ href }) {
        const { host, protocol } = window.location
        const route = href.replace(`${ protocol }//${ host }`, '')

        history.pushState(null, null, href )
        this.set({ route })
      },
    },

    onrender() {
      window.addEventListener('popstate', () => {
        // this.set({ time: new Date() });
        console.log('popstate')
      })
    },

    onteardown() {
      window.removeEventListener('popstate')
    },

    components: {
      Header,
      IndexPage,
      TimerPage,
      CategoriesPage,
    },
  }
</script>
